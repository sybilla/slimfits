/**
  @license
  license
 **/
"format register";System.register("sybilla/Interfaces",[],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0,e.Constants={blockLength:2880,lineLength:80,keyLength:8,maxKeywordsInBlock:36},function(e){e[e.Byte=8]="Byte",e[e.Char=8]="Char",e[e.Short=16]="Short",e[e.Integer=32]="Integer",e[e.Long=64]="Long",e[e.Float=-32]="Float",e[e.Double=-64]="Double",e[e.Unknown=0]="Unknown"}(e.BitPix||(e.BitPix={}));var a=e.BitPix,i=function(){function e(){}return e.getByteSize=function(e){return Math.abs(e)/8},e.getBitPixForLetter=function(e){switch(e){case"A":return a.Byte;case"B":return a.Byte;case"I":return a.Short;case"J":return a.Integer;case"K":return a.Long;case"E":return a.Float;case"D":return a.Double;default:throw"unrecognized format"}},e}();return e.BitPixUtils=i,r.define=n,t.exports}),System.register("sybilla/utils/ValueConverters",[],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=function(){function e(){}return e.prototype.convert=function(e){return e.replace(/\'/g,"''")},e.prototype.convertBack=function(e){return"'"===e.charAt(0)&&(e=e.substr(1)),"'"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),e.replace(/\'\'/g,"'").toString().trim()},e}();e.StringConverter=a;var i=function(){function e(){}return e.prototype.convert=function(e){return e.toString()},e.prototype.convertBack=function(e){return parseInt(e)},e}();e.IntConverter=i;var o=function(){function e(){}return e.prototype.convert=function(e){return e.toString()},e.prototype.convertBack=function(e){return parseFloat(e)},e}();e.FloatConverter=o;var s=function(){function e(){}return e.prototype.convert=function(e){return console.warn("DateFitsValueConverter.convert not implemented."),""},e.prototype.convertBack=function(e){return"'"===e[0]&&(e=e.slice(1)),"'"===e[e.length-1]&&(e=e.slice(0,e.length-1)),isNaN(Date.parse(e))?(console.error("DateFitsValueConverter.convertBack error parsing "+e),null):new Date(e)},e}();e.DateConverter=s;var u=function(){function e(){}return e.prototype.convert=function(e){return e?"T":"F"},e.prototype.convertBack=function(e){return"T"===e.toString().trim().toUpperCase()},e}();e.BooleanConverter=u;var l=function(){function e(){}return e.prototype.convert=function(e){return e.toString()},e.prototype.convertBack=function(e){return parseInt(e)},e}();e.BitPixConverter=l;var c={ZBITPIX:new l,BITPIX:new l,NAXIS:new i,NAXIS1:new i,NAXIS2:new i,NAXIS3:new i,YBINNING:new i,XBINNING:new i,PCOUNT:new i,GCOUNT:new i,NSEGMENT:new i,BSCALE:new o,BZERO:new o,EPOCH:new a,EQUINOX:new o,ALTRVAL:new o,ALTRPIX:new o,RESTFREQ:new o,DATAMAX:new o,DATAMIN:new o,RA:new o,DEC:new o,OBSRA:new o,OBSDEC:new o,XSHIFT:new o,YSHIFT:new o,SIMPLE:new u,GROUPS:new u,BLOCKED:new u,EXTEND:new u,SEQVALID:new u,TFIELDS:new i,ZIMAGE:new u,ZVAL1:new i,ZVAL2:new i},f={NAXIS:new i,NSEG:new i,CRVAL:new o,CDELT:new o,CRPIX:new o,CROTA:new o,PHAS:new o,PSCAL:new o,PZERO:new o,SDLT:new o,SRVL:new o,SRPX:new o,DBJD:new o,"THDA-":new o},y={"int":new i,"float":new o,string:new a,date:new s,"boolean":new u};return e.ValueConverters={registeredNames:c,registeredPrefixedNames:f,registeredTypes:y,defaultConverter:new a},r.define=n,t.exports}),function(){function e(){}e.amd={},function(){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function r(e){return"function"==typeof e}function n(e){X=e}function a(e){q=e}function i(){return function(){process.nextTick(c)}}function o(){return function(){O(c)}}function s(){var e=0,t=new Y(c),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function u(){var e=new MessageChannel;return e.port1.onmessage=c,function(){e.port2.postMessage(0)}}function l(){return function(){setTimeout(c,1)}}function c(){for(var e=0;G>e;e+=2){var t=J[e],r=J[e+1];t(r),J[e]=void 0,J[e+1]=void 0}G=0}function f(){try{var e=require,t=e("vertx");return O=t.runOnLoop||t.runOnContext,o()}catch(r){return l()}}function y(e,t){var r=this,n=r._state;if(n===re&&!e||n===ne&&!t)return this;var a=new this.constructor(g),i=r._result;if(n){var o=arguments[n-1];q(function(){D(n,a,o,i)})}else P(r,a,e,t);return a}function d(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var r=new t(g);return S(r,e),r}function g(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function h(e){try{return e.then}catch(t){return ae.error=t,ae}}function w(e,t,r,n){try{e.call(t,r,n)}catch(a){return a}}function b(e,t,r){q(function(e){var n=!1,a=w(r,t,function(r){n||(n=!0,t!==r?S(e,r):I(e,r))},function(t){n||(n=!0,R(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&a&&(n=!0,R(e,a))},e)}function m(e,t){t._state===re?I(e,t._result):t._state===ne?R(e,t._result):P(t,void 0,function(t){S(e,t)},function(t){R(e,t)})}function A(e,t,n){t.constructor===e.constructor&&n===$&&constructor.resolve===ee?m(e,t):n===ae?R(e,ae.error):void 0===n?I(e,t):r(n)?b(e,t,n):I(e,t)}function S(e,r){e===r?R(e,v()):t(r)?A(e,r,h(r)):I(e,r)}function B(e){e._onerror&&e._onerror(e._result),C(e)}function I(e,t){e._state===te&&(e._result=t,e._state=re,0!==e._subscribers.length&&q(C,e))}function R(e,t){e._state===te&&(e._state=ne,e._result=t,q(B,e))}function P(e,t,r,n){var a=e._subscribers,i=a.length;e._onerror=null,a[i]=t,a[i+re]=r,a[i+ne]=n,0===i&&e._state&&q(C,e)}function C(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,a,i=e._result,o=0;o<t.length;o+=3)n=t[o],a=t[o+r],n?D(r,n,a,i):a(i);e._subscribers.length=0}}function x(){this.error=null}function T(e,t){try{return e(t)}catch(r){return ie.error=r,ie}}function D(e,t,n,a){var i,o,s,u,l=r(n);if(l){if(i=T(n,a),i===ie?(u=!0,o=i.error,i=null):s=!0,t===i)return void R(t,p())}else i=a,s=!0;t._state!==te||(l&&s?S(t,i):u?R(t,o):e===re?I(t,i):e===ne&&R(t,i))}function M(e,t){try{t(function(t){S(e,t)},function(t){R(e,t)})}catch(r){R(e,r)}}function U(e){return new fe(this,e).promise}function k(e){function t(e){S(a,e)}function r(e){R(a,e)}var n=this,a=new n(g);if(!H(e))return R(a,new TypeError("You must pass an array to race.")),a;for(var i=e.length,o=0;a._state===te&&i>o;o++)P(n.resolve(e[o]),void 0,t,r);return a}function N(e){var t=this,r=new t(g);return R(r,e),r}function _(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function L(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function E(e){this._id=le++,this._state=void 0,this._result=void 0,this._subscribers=[],g!==e&&("function"!=typeof e&&_(),this instanceof E?M(this,e):L())}function F(e,t){this._instanceConstructor=e,this.promise=new e(g),Array.isArray(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?I(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&I(this.promise,this._result))):R(this.promise,this._validationError())}function V(){var e;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var r=e.Promise;r&&"[object Promise]"===Object.prototype.toString.call(r.resolve())&&!r.cast||(e.Promise=ce)}var K;K=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var O,X,z,H=K,G=0,q=function(e,t){J[G]=e,J[G+1]=t,G+=2,2===G&&(X?X(c):z())},Z="undefined"!=typeof window?window:void 0,j=Z||{},Y=j.MutationObserver||j.WebKitMutationObserver,Q="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),W="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,J=new Array(1e3);z=Q?i():Y?s():W?u():void 0===Z&&"function"==typeof require?f():l();var $=y,ee=d,te=void 0,re=1,ne=2,ae=new x,ie=new x,oe=U,se=k,ue=N,le=0,ce=E;E.all=oe,E.race=se,E.resolve=ee,E.reject=ue,E._setScheduler=n,E._setAsap=a,E._asap=q,E.prototype={constructor:E,then:$,"catch":function(e){return this.then(null,e)}};var fe=F;F.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},F.prototype._enumerate=function(){for(var e=this.length,t=this._input,r=0;this._state===te&&e>r;r++)this._eachEntry(t[r],r)},F.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===ee){var a=h(e);if(a===$&&e._state!==te)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(r===ce){var i=new r(g);A(i,e,a),this._willSettleAt(i,t)}else this._willSettleAt(new r(function(t){t(e)}),t)}else this._willSettleAt(n(e),t)},F.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===te&&(this._remaining--,e===ne?R(n,r):this._result[t]=r),0===this._remaining&&I(n,this._result)},F.prototype._willSettleAt=function(e,t){var r=this;P(e,void 0,function(e){r._settledAt(re,t,e)},function(e){r._settledAt(ne,t,e)})};var ye=V,de={Promise:ce,polyfill:ye};"function"==typeof e&&e.amd?System.register("es6-promise",[],!1,function(){return de}):"undefined"!=typeof module&&module.exports?module.exports=de:"undefined"!=typeof this&&(this.ES6Promise=de),ye()}.call(this)}(),System.register("sybilla/datareaders/SimpleDataReader",["sybilla/Interfaces","sybilla/utils/KeywordsManager","es6-promise"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/Interfaces"),i=require("sybilla/utils/KeywordsManager"),o=require("es6-promise"),s=function(){function e(){}return e.prototype.canReadData=function(e){return(i.KeywordsManager.hasValue(e,"SIMPLE",!0)||i.KeywordsManager.hasValue(e,"XTENSION","IMAGE"))&&!i.KeywordsManager.hasValue(e,"GROUPS",!0)},e.prototype.readDataSize=function(e){var t=i.KeywordsManager.getValue(e,"BITPIX",a.BitPix.Unknown),r=a.BitPixUtils.getByteSize(t);if(i.KeywordsManager.hasValue(e,"NAXIS",0))return 0;var n=e.filter(function(e){return 0===e.key.indexOf("NAXIS")&&"NAXIS"!==e.key}).reduce(function(e,t){return e*t.value},1);return Math.ceil(r*n/a.Constants.blockLength)*a.Constants.blockLength},e.prototype.readDataAsync=function(e,t,r,n){void 0===n&&(n=!0);var s=i.KeywordsManager.getValue(r,"BITPIX",a.BitPix.Unknown),u=r.filter(function(e){return 0===e.key.indexOf("NAXIS",0)&&"NAXIS"!==e.key}),l=u.map(function(e){return e.value}).reduce(function(e,t){return e*t},1),c=i.KeywordsManager.getValue(r,"BSCALE",1),f=i.KeywordsManager.getValue(r,"BZERO",0);if(u.length>0&&0!==l){var y=e.getDataAsync(t,l,s,n);return 1!==c||0!==f?y.then(function(e){for(var t=0;t<e.length;t++)e[t]=e[t]*c+f;return e}):y}var d=null;return o.Promise.resolve(d)},e}();return e.SimpleDataReader=s,r.define=n,t.exports}),System.register("sybilla/utils/AsciiConverter",[],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=function(){function e(){}return e.test=function(e,t){return new RegExp(e).test(t)},e.String="A\\d{1,}",e.Integer="I\\d{1,}",e.Float="F\\d{1,}\\.?\\d{0,}",e.Double="(D|E)\\d{1,}\\.?\\d{0,}",e}(),i=function(){function e(){}return e.getConverterFor=function(e,t){if(a.test(a.String,e))return{converter:function(e){return e},array:new Array(t)};if(a.test(a.Integer,e))return{converter:function(e){return""===e?0:parseInt(e)},array:new Int32Array(t)};if(a.test(a.Float,e))return{converter:function(e){return""===e?0:parseFloat(e)},array:new Float32Array(t)};if(a.test(a.Double,e))return{converter:function(e){return""===e?0:parseFloat(e)},array:new Float64Array(t)};throw"AsciiConvertManager: No converter registered for "+e},e}();return e.AsciiConverter=i,r.define=n,t.exports}),System.register("sybilla/utils/ArrayUtils",["sybilla/Interfaces"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/Interfaces"),i=function(){function e(){}return e.copy=function(e,t,r,n,i,o){if(void 0===o&&(o=!0),0==n)throw"Length of copied array cannot be 0";if(i==a.BitPix.Unknown)throw"Unknown array element type";var s=[new Uint8Array(e),new Uint8Array(t)],u=s[0],l=s[1],c=a.BitPixUtils.getByteSize(i),f=n*c;if(o&&1!==c)for(var y=0;n>y;y++)for(var d=0;c>d;d++)l[c*y+d]=u[r+c*y+(c-(d+1))];else for(var y=0;f>y;y++)l[y]=u[r+y]},e.generateTypedArray=function(e,t){if(0==t)throw"Length of created array cannot be 0";switch(e){case a.BitPix.Byte:return new Uint8Array(t);case a.BitPix.Short:return new Int16Array(t);case a.BitPix.Integer:return new Int32Array(t);case a.BitPix.Float:return new Float32Array(t);case a.BitPix.Double:return new Float64Array(t);default:throw"Cannot create array of unknown type"}},e.pluckColumn=function(e,t,r,n,i,o,s,u){var l=[new Uint8Array(e),new Uint8Array(t)],c=l[0],f=l[1],y=a.BitPixUtils.getByteSize(s);if(u&&1!==y)for(var d=0;r>d;d++)for(var g=0;o>g;g++)for(var v=0;y>v;v++)f[d*o*y+g*y+v]=c[d*n+i+g*y+(y-(v+1))];else for(var d=0;r>d;d++)for(var g=0;o>g;g++)for(var v=0;y>v;v++)f[d*o*y+g*y+v]=c[d*n+i+g*y+v]},e.chunk=function(e,t,r){var n=a.BitPixUtils.getByteSize(t)*r,i=e.byteLength/n,o=[];switch(t){case a.BitPix.Byte:for(var s=0;i>s;s++)o.push(new Uint8Array(e,s*n,r));return o;case a.BitPix.Short:for(var s=0;i>s;s++)o.push(new Int16Array(e,s*n,r));return o;case a.BitPix.Integer:for(var s=0;i>s;s++)o.push(new Int32Array(e,s*n,r));return o;case a.BitPix.Float:for(var s=0;i>s;s++)o.push(new Float32Array(e,s*n,r));return o;case a.BitPix.Double:for(var s=0;i>s;s++)o.push(new Float64Array(e,s*n,r));return o;default:throw"Cannot create array of unknown type"}},e}();return e.ArrayUtils=i,r.define=n,t.exports}),System.register("sybilla/datareaders/RandomGroupsDataReader",["sybilla/Interfaces","sybilla/utils/KeywordsManager","sybilla/utils/ArrayUtils"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/Interfaces"),i=require("sybilla/utils/KeywordsManager"),o=require("sybilla/utils/ArrayUtils"),s=function(){function e(){}return e.prototype.canReadData=function(e){return i.KeywordsManager.hasValue(e,"GROUPS",!0)&&i.KeywordsManager.hasValue(e,"NAXIS1",0)},e.prototype.readDataSize=function(e){var t=i.KeywordsManager.getValue(e,"BITPIX",a.BitPix.Unknown),r=e.filter(function(e){return 0===e.key.indexOf("NAXIS")&&"NAXIS"!==e.key&&"NAXIS1"!==e.key&&1!==e.value}).reduce(function(e,t){return e*t.value},1),n=i.KeywordsManager.getValue(e,"GCOUNT",0),o=i.KeywordsManager.getValue(e,"PCOUNT",0),s=a.BitPixUtils.getByteSize(t);return Math.ceil(n*(o+r)*s/a.Constants.blockLength)*a.Constants.blockLength},e.prototype.readDataAsync=function(e,t,r,n){void 0===n&&(n=!0);var s=i.KeywordsManager.getValue(r,"BITPIX",a.BitPix.Unknown),u=a.BitPixUtils.getByteSize(s),l=i.KeywordsManager.getValue(r,"GCOUNT",0),c=i.KeywordsManager.getValue(r,"PCOUNT",0),f=r.filter(function(e){return 0===e.key.indexOf("NAXIS")&&"NAXIS"!==e.key&&"NAXIS1"!==e.key&&1!==e.value}).reduce(function(e,t){return e*t.value},1),y=c+f,d=c*u;return e.getDataAsync(t,y*l,s,n).then(function(e){var t=o.ArrayUtils.generateTypedArray(s,l*c),r=o.ArrayUtils.generateTypedArray(s,l*f);return o.ArrayUtils.pluckColumn(e.buffer,t.buffer,l,y*u,0,c,s,!1),o.ArrayUtils.pluckColumn(e.buffer,r.buffer,l,y*u,d,f,s,!1),{params:o.ArrayUtils.chunk(t.buffer,s,c),data:o.ArrayUtils.chunk(r.buffer,s,f)}})},e}();return e.RandomGroupsDataReader=s,r.define=n,t.exports}),System.register("sybilla/utils/Rice",[],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=function(){function e(){}return e.getNonzeroCount=function(){for(var e=new Uint8Array(256),t=1,r=1;8>=r;r++)for(var n=0;n<Math.pow(2,r-1);n++)e[t++]=r;return e},e.fits_rdecomp=function(t,r,n){var a=e.getNonzeroCount(),i=0,o=5,s=25,u=1<<o|0,l=new DataView(t.buffer).getInt32(0,!1);i+=4;for(var c=t[i++],f=8,y=0;y<r.length;){for(f-=o;0>f;)c=c<<8|t[i++],f+=8;var d=(c>>f)-1;c&=(1<<f)-1;var g=y+n;if(g>r.length&&(g=r.length),0>d)for(;g>y;y++)r[y]=l;else if(d==s)for(;g>y;y++){var v=u-f,p=c<<v;for(v-=8;v>=0;v-=8)c=t[i++],p|=c<<v;f>0?(c=t[i++],p|=c>>-v,c&=(1<<f)-1):c=0,0==(1&p)?p>>=1:p=~(p>>1),r[y]=p+l,l=r[y]}else for(;g>y;y++){for(;0==c;)f+=8,c=t[i++];var h=f-a[c];for(f-=h+1,c^=1<<f,f-=d;0>f;)c=c<<8|t[i++],f+=8;var p=h<<d|c>>f;c&=(1<<f)-1,0==(1&p)?p>>=1:p=~(p>>1),r[y]=p+l,l=r[y]}}},e.fits_rdecomp_short=function(t,r,n){var a=e.getNonzeroCount(),i=0,o=4,s=14,u=1<<o,l=new DataView(t.buffer).getInt16(0,!1);i+=2;for(var c=t[i++],f=8,y=0;y<r.length;){for(f-=o;0>f;)c=c<<8|t[i++],f+=8;var d=(c>>f)-1;c&=(1<<f)-1;var g=y+n;if(g>r.length&&(g=r.length),0>d)for(;g>y;y++)r[y]=l;else if(d==s)for(;g>y;y++){var v=u-f,p=c<<v;for(v-=8;v>=0;v-=8)c=t[i++],p|=c<<v;f>0?(c=t[i++],p|=c>>-v,c&=(1<<f)-1):c=0,0==(1&p)?p>>=1:p=~(p>>1),r[y]=p+l,l=r[y]}else for(;g>y;y++){for(;0==c;)f+=8,c=t[i++];var h=f-a[c];for(f-=h+1,c^=1<<f,f-=d;0>f;)c=c<<8|t[i++],f+=8;var p=h<<d|c>>f;c&=(1<<f)-1,0==(1&p)?p>>=1:p=~(p>>1),r[y]=p+l,l=r[y]}}},e.fits_rdecomp_byte=function(t,r,n){var a=e.getNonzeroCount(),i=0,o=3,s=6,u=1<<o,l=t[0];i+=1;for(var c=t[i++],f=8,y=0;y<r.length;){for(f-=o;0>f;)c=c<<8|t[i++],f+=8;var d=(c>>f)-1;c&=(1<<f)-1;var g=y+n;if(g>r.length&&(g=r.length),0>d)for(;g>y;y++)r[y]=l;else if(d==s)for(;g>y;y++){var v=u-f,p=c<<v;for(v-=8;v>=0;v-=8)c=t[i++],p|=c<<v;f>0?(c=t[i++],p|=c>>-v,c&=(1<<f)-1):c=0,0==(1&p)?p>>=1:p=~(p>>1),r[y]=p+l,l=r[y]}else for(;g>y;y++){for(;0==c;)f+=8,c=t[i++];var h=f-a[c];for(f-=h+1,c^=1<<f,f-=d;0>f;)c=c<<8|t[i++],f+=8;var p=h<<d|c>>f;c&=(1<<f)-1,0==(1&p)?p>>=1:p=~(p>>1),r[y]=p+l,l=r[y]}}},e}();return e.Rice=a,r.define=n,t.exports}),System.register("sybilla/datasource/BlobFile",["sybilla/Interfaces","sybilla/utils/ArrayUtils","es6-promise"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/Interfaces"),i=require("sybilla/utils/ArrayUtils"),o=require("es6-promise"),s=function(){function e(e){this.file=e,this.url="",this.url=e.name}return e.prototype.initialize=function(){return o.Promise.resolve(!0)},e.prototype.getByteLength=function(){return this.file.size},e.prototype.getStringAsync=function(e,t){var r=this;return new o.Promise(function(n,a){var i=r.file.slice(e,e+t),o=new FileReader;o.onloadend=function(e){var t=e.target;t.readyState==t.DONE?n(t.result):a(t.error)},o.readAsText(i)})},e.prototype.getDataAsync=function(e,t,r,n){var s=this;return void 0===n&&(n=!0),new o.Promise(function(o,u){var l=s.file.slice(e,e+t*a.BitPixUtils.getByteSize(r)),c=new FileReader;c.onloadend=function(a){var s=a.target;if(s.readyState==s.DONE){var l=i.ArrayUtils.generateTypedArray(r,t);i.ArrayUtils.copy(s.result,l.buffer,e,t,r,n),o(l)}else u(s.error)},c.readAsArrayBuffer(l)})},e}();return e.BlobFile=s,r.define=n,t.exports}),System.register("sybilla/utils/Header",[],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},i=function(){function e(e,t){this.name=e,this.value=t}return e}();e.Header=i;var o=function(e){function t(t,r){e.call(this,"Range","bytes="+t+"-"+(t+r-1)),this.from=t,this.length=r}return a(t,e),t}(i);return e.AcceptRangeHeader=o,r.define=n,t.exports}),System.register("sybilla/datasource/SingleRequestFile",["sybilla/utils/PromiseUtils","sybilla/utils/ArrayUtils","es6-promise"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/utils/PromiseUtils"),i=require("sybilla/utils/ArrayUtils"),o=require("es6-promise"),s=function(){function e(e){this.url=e,this.data=null}return e.prototype.initialize=function(){var e=this;return a.PromiseUtils.getRequestAsync(this.url).then(function(t){return e.data=t.response,e.data})},e.prototype.getByteLength=function(){return null!=this.data?this.data.byteLength:0},e.prototype.getStringAsync=function(e,t){return o.Promise.resolve(String.fromCharCode.apply(null,new Uint8Array(this.data,e,t)))},e.prototype.getDataAsync=function(e,t,r,n){void 0===n&&(n=!0);var a=i.ArrayUtils.generateTypedArray(r,t);return i.ArrayUtils.copy(this.data,a.buffer,e,t,r,n),o.Promise.resolve(a)},e}();return e.SingleRequestFile=s,r.define=n,t.exports}),System.register("sybilla/utils/KeywordsManager",["sybilla/utils/ValueConverters","sybilla/Interfaces"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/utils/ValueConverters"),i=require("sybilla/Interfaces"),o=function(){function e(e,t,r){void 0===t&&(t=null),void 0===r&&(r=null),this.key=e,this.value=t,this.comment=r}return e.isLastLine=function(e){return 0===e.indexOf("END     ",0)},e}();e.Keyword=o;var s=function(){function e(){}return e.getConverterByName=function(e){if(e in a.ValueConverters.registeredNames)return a.ValueConverters.registeredNames[e];var t=Object.keys(a.ValueConverters.registeredPrefixedNames).filter(function(t){return 0===e.indexOf(t)});return t.length>0?a.ValueConverters.registeredPrefixedNames[t[0]]:a.ValueConverters.defaultConverter},e.isInt=function(e){return"number"==typeof e&&parseFloat(e.toString())===parseInt(e.toString(),10)&&!isNaN(e)},e.getConverterByType=function(e){return e in a.ValueConverters.registeredTypes?a.ValueConverters.registeredTypes[e]:a.ValueConverters.defaultConverter},e.single=function(e,t){return e.filter(function(e){return e.key==t})[0]},e.getValue=function(e,t,r){var n=e.filter(function(e){return e.key==t});return 0==n.length?r:n[0].value},e.hasValue=function(e,t,r){return e.some(function(e){return e.key==t&&e.value==r})},e.hasValueFromList=function(e,t,r){return e.some(function(e){return e.key==t&&r.indexOf(e.value)>-1})},e.convert=function(t){var r=typeof t;return"number"===r&&(r=e.isInt(t)?"int":"float"),("object"===r?t.getMonth:void 0)&&(r="date"),e.getConverterByType(r)},e.convertBack=function(t,r){var n=e.getConverterByName(r);return n.convertBack(t)},e.parseKeyword=function(t){var r=new o(t.substring(0,i.Constants.keyLength).trim());if("= "===t.substr(i.Constants.keyLength,2))if("/"===t.charAt(31))r.value=e.convertBack(t.substr(10,21).trim(),r.key),r.comment=t.substr(32).trim();else{var n=t.substr(10,i.Constants.lineLength-10),a=n.lastIndexOf(" /"),s=-1===a;s?r.value=e.convertBack(n.trim(),r.key):(r.value=e.convertBack(n.substring(0,a).trim(),r.key),r.comment=n.substring(a+1).trim())}else{var u=t.substr(i.Constants.keyLength,i.Constants.lineLength-i.Constants.keyLength);r.value=e.convertBack(u,r.key)}return r},e}();return e.KeywordsManager=s,r.define=n,t.exports}),System.register("sybilla/utils/PromiseUtils",["es6-promise"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("es6-promise"),i=function(){function e(){}return e.getRequestAsync=function(e,t,r,n){return void 0===t&&(t="GET"),void 0===r&&(r="arraybuffer"),void 0===n&&(n=[]),new a.Promise(function(a,i){var o=new XMLHttpRequest;o.open(t,e),o.responseType=r,n.forEach(function(e){o.setRequestHeader(e.name,e.value)}),o.onload=function(){this.status>=200&&this.status<300?a(o):i({status:this.status,statusText:o.statusText})},o.onerror=function(){i({status:this.status,statusText:o.statusText})},o.send()})},e.promiseWhile=function(e,t){return new a.Promise(function(r,n){var i=function(){return e()?new a.Promise(function(e,r){try{e(t())}catch(n){r(n)}}).then(i)["catch"](function(e){return n(e)}):(r(void 0),null)};setTimeout(i,30)})},e}();return e.PromiseUtils=i,r.define=n,t.exports}),System.register("sybilla/datareaders/AsciiTableDataReader",["sybilla/Interfaces","sybilla/utils/KeywordsManager","sybilla/utils/AsciiConverter"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/Interfaces"),i=require("sybilla/utils/KeywordsManager"),o=require("sybilla/utils/AsciiConverter"),s=function(){function e(){}return e.prototype.canReadData=function(e){return i.KeywordsManager.hasValue(e,"XTENSION","TABLE")},e.prototype.readDataSize=function(e){var t=i.KeywordsManager.getValue(e,"NAXIS2",1),r=i.KeywordsManager.getValue(e,"NAXIS1",1);return Math.ceil(r*t/a.Constants.blockLength)*a.Constants.blockLength},e.prototype.readDataAsync=function(e,t,r){var n=i.KeywordsManager.getValue(r,"NAXIS2",1),a=i.KeywordsManager.getValue(r,"NAXIS1",1),s=i.KeywordsManager.getValue(r,"TFIELDS",0),u=r.filter(function(e){return 0===e.key.indexOf("TFORM")}).map(function(e){return o.AsciiConverter.getConverterFor(e.value,n)}),l=u.map(function(e){return e.converter}),c=u.map(function(e){return e.array}),f=r.filter(function(e){return 0===e.key.indexOf("TBCOL")}).map(function(e){return e.value-1}).concat([a]);if(f.length+1!==s)throw"There are "+f.length+" 'TBCOL#' keywords whereas 'TFIELDS' specifies "+s;return e.getStringAsync(t,a*n).then(function(e){for(var t=0;n>t;t++)for(var r=e.substr(t*a,a),i=0;s>i;i++){var o=r.substr(f[i],f[i+1]-f[i]);c[i][t]=l[i](o.trim())}return c})},e}();return e.AsciiTableDataReader=s,r.define=n,t.exports}),System.register("sybilla/datareaders/BinaryTableDataReader",["sybilla/Interfaces","sybilla/utils/KeywordsManager","sybilla/utils/ArrayUtils"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/Interfaces"),i=require("sybilla/utils/KeywordsManager"),o=require("sybilla/utils/ArrayUtils"),s=function(){function e(){}return e.prototype.canReadData=function(e){return i.KeywordsManager.hasValueFromList(e,"XTENSION",["BINTABLE","A3DTABLE"])&&!i.KeywordsManager.hasValue(e,"ZIMAGE",!0)},e.prototype.readDataSize=function(e){var t=i.KeywordsManager.getValue(e,"NAXIS2",1),r=i.KeywordsManager.getValue(e,"NAXIS1",1);return Math.ceil(r*t/a.Constants.blockLength)*a.Constants.blockLength},e.prototype.readColumn=function(e,t,r,n,i,s){if(0==i)return[];var u="A"==s?a.BitPix.Byte:a.BitPixUtils.getBitPixForLetter(s),l=new ArrayBuffer(a.BitPixUtils.getByteSize(u)*t*i);o.ArrayUtils.pluckColumn(e,l,t,r,n,i,u,!0);var c=o.ArrayUtils.chunk(l,u,i);return"A"==s?c.map(function(e){return String.fromCharCode.apply(null,e)}):c},e.prototype.readDataAsync=function(e,t,r){var n=this,o=i.KeywordsManager.getValue(r,"NAXIS2",0),s=i.KeywordsManager.getValue(r,"NAXIS1",0),u=0,l=new RegExp("\\d+\\w"),c=r.filter(function(e){return 0===e.key.indexOf("TFORM")&&l.test(e.value)}).map(function(e){var t=e.value.substr(e.value.length-1,1),r=parseInt(e.value.substr(0,e.value.length-1)),n=u,i="A"==t?a.BitPix.Byte:a.BitPixUtils.getBitPixForLetter(t);return u+=r*a.BitPixUtils.getByteSize(i),{format:t,count:r,byteOffset:n}});return e.getDataAsync(t,o*s,a.BitPix.Byte).then(function(e){return c.map(function(t){return n.readColumn(e.buffer,o,s,t.byteOffset,t.count,t.format)})})},e}();return e.BinaryTableDataReader=s,r.define=n,t.exports}),System.register("sybilla/datareaders/CompressedImageReader",["sybilla/Interfaces","sybilla/utils/KeywordsManager","sybilla/utils/Rice","es6-promise"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/Interfaces"),i=require("sybilla/utils/KeywordsManager"),o=require("sybilla/utils/Rice"),s=require("es6-promise"),u=function(){function e(){}return e.prototype.canReadData=function(e){return i.KeywordsManager.hasValueFromList(e,"XTENSION",["BINTABLE","A3DTABLE"])&&i.KeywordsManager.hasValue(e,"ZIMAGE",!0)},e.prototype.readDataSize=function(e){var t=i.KeywordsManager.getValue(e,"PCOUNT",0),r=i.KeywordsManager.getValue(e,"NAXIS2",0),n=a.BitPixUtils.getByteSize(a.BitPix.Integer),o=2*r*n;return Math.ceil((t+o)/a.Constants.blockLength)*a.Constants.blockLength},e.convertToTiles=function(e,t){for(var r=[],n=e.length/2,a=0;n>a;a++)r.push(new Uint8Array(t.buffer,e[2*a+1],e[2*a]));return r},e.riceExtract=function(e,t,r){return e},e.prototype.readDataAsync=function(t,r,n){var u=i.KeywordsManager.getValue(n,"NAXIS2",0),l=(i.KeywordsManager.getValue(n,"NAXIS1",0),i.KeywordsManager.getValue(n,"TFIELDS",0),new RegExp("\\d{0,}\\D"),new RegExp("([01]{0,1})([PQ])([ABIJKED])\\((\\d+)\\)")),c=(i.KeywordsManager.getValue(n,"THEAP",0),i.KeywordsManager.getValue(n,"PCOUNT",0)),f=(i.KeywordsManager.getValue(n,"GCOUNT",0),i.KeywordsManager.getValue(n,"ZCMPTYPE","")),y=n.filter(function(e){return 0==e.key.indexOf("TFORM")}).some(function(e){return l.test(e.value)});if(y){var d=n.filter(function(e){return 0==e.key.indexOf("TFORM")&&l.test(e.value)})[0],g=l.exec(d.value),v=g[2],p=g[3];parseInt(g[4]);if("P"!==v)throw"Pointer format other than Int32 unsupported";if("B"!==p)throw"Element format other than Byte currently unsupported";if("RICE_1"!==f)throw"Decompression other than Rice is not currently supported";var h=n.filter(function(e){return 0==e.key.indexOf("ZTILE")&&"ZTILE"!==e.key}),w=h.reduce(function(e,t){return e*t.value},1),b=i.KeywordsManager.getValue(n,"ZVAL1",32),m=i.KeywordsManager.getValue(n,"ZVAL2",4),A=(i.KeywordsManager.getValue(n,"ZBITPIX",a.BitPix.Unknown),a.BitPixUtils.getByteSize(a.BitPix.Integer)),S=2*u,B=S*A,I=[t.getDataAsync(r,S,a.BitPix.Integer),t.getDataAsync(r+B,c,a.BitPix.Byte)];return s.Promise.all(I).then(function(t){var r=e.convertToTiles(t[0],t[1]),s=[],u=b/8*w,l=new ArrayBuffer(u*r.length),c=i.KeywordsManager.getValue(n,"BSCALE",1),f=i.KeywordsManager.getValue(n,"BZERO",0);return m==a.BitPixUtils.getByteSize(a.BitPix.Integer)?s=r.map(function(e,t){var r=new Int32Array(l,t*u,w);o.Rice.fits_rdecomp(e,r,b);for(var n=e.length;n--;)r[n]=c*r[n]+f;return r}):m==a.BitPixUtils.getByteSize(a.BitPix.Short)?s=r.map(function(e,t){var r=new Int16Array(l,t*u,w);o.Rice.fits_rdecomp_short(e,r,b);for(var n=e.length;n--;)r[n]=c*r[n]+f;return r}):m==a.BitPixUtils.getByteSize(a.BitPix.Byte)&&(s=r.map(function(e,t){var r=new Uint8Array(l,t*u,w);o.Rice.fits_rdecomp_byte(e,r,b);for(var n=e.length;n--;)r[n]=c*r[n]+f;return r})),s})}throw"Compressed image should have one variable column."},e}();return e.CompressedImageReader=u,r.define=n,t.exports}),System.register("sybilla/datasource/MultipleRequestFile",["sybilla/utils/Header","sybilla/utils/PromiseUtils","sybilla/utils/ArrayUtils"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/utils/Header"),i=require("sybilla/utils/PromiseUtils"),o=require("sybilla/utils/ArrayUtils"),s=function(){function e(e){this.url=e,this.size=0}return e.parseHeaders=function(e){return e?e.split("\r\n").filter(function(e){return""!==e||""!==e.trim()}).map(function(e){var t=e.indexOf(": ");return t>0?new a.Header(e.substring(0,t),e.substring(t+2)):null}):[]},e.prototype.initialize=function(){var t=this;return i.PromiseUtils.getRequestAsync(this.url,"HEAD","text").then(function(r){var n=e.parseHeaders(r.getAllResponseHeaders());if(n.some(function(e){return"Accept-Ranges"==e.name&&"bytes"==e.value})){var a=n.filter(function(e){return"Content-Length"==e.name});return t.size=parseInt(a[0].value),null}throw"File does not support Ranges request keyword"})},e.prototype.getByteLength=function(){return this.size},e.prototype.getStringAsync=function(e,t){var r=[new a.AcceptRangeHeader(e,t)];return i.PromiseUtils.getRequestAsync(this.url,"GET","text",r).then(function(e){return e.responseText})},e.prototype.getDataAsync=function(e,t,r,n){void 0===n&&(n=!0);var s=o.ArrayUtils.generateTypedArray(r,t),u=s.BYTES_PER_ELEMENT*t,l=[new a.AcceptRangeHeader(e,u)];return i.PromiseUtils.getRequestAsync(this.url,"GET","arraybuffer",l).then(function(e){var a=e.response;return o.ArrayUtils.copy(a,s.buffer,0,t,r,n),s})},e}();return e.MultipleRequestFile=s,r.define=n,t.exports}),System.register("sybilla/RegisteredDataReaders",["sybilla/datareaders/SimpleDataReader","sybilla/datareaders/AsciiTableDataReader","sybilla/datareaders/BinaryTableDataReader","sybilla/datareaders/RandomGroupsDataReader","sybilla/datareaders/CompressedImageReader"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/datareaders/SimpleDataReader"),i=require("sybilla/datareaders/AsciiTableDataReader"),o=require("sybilla/datareaders/BinaryTableDataReader"),s=require("sybilla/datareaders/RandomGroupsDataReader"),u=require("sybilla/datareaders/CompressedImageReader");
return e.RegisteredDataReaders=[new a.SimpleDataReader,new i.AsciiTableDataReader,new o.BinaryTableDataReader,new s.RandomGroupsDataReader,new u.CompressedImageReader],r.define=n,t.exports}),System.register("sybilla/FitsReader",["sybilla/Interfaces","sybilla/utils/KeywordsManager","sybilla/utils/PromiseUtils","sybilla/RegisteredDataReaders"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/Interfaces"),i=require("sybilla/utils/KeywordsManager"),o=require("sybilla/utils/PromiseUtils"),s=require("sybilla/RegisteredDataReaders"),u=function(){function e(){}return e.readFitsAsync=function(t){var r=[],n=0;return o.PromiseUtils.promiseWhile(function(){return n<t.getByteLength()},function(){return e.readHduAsync(t,n).then(function(e){r.push(e),n+=e.bytesRead})}).then(function(){return r})},e.readHeaderAsync=function(e,t){var r=!1,n=[],s=0;return o.PromiseUtils.promiseWhile(function(){return!r},function(){return e.getStringAsync(t+s,a.Constants.blockLength).then(function(e){s+=a.Constants.blockLength;for(var t=0;t<a.Constants.maxKeywordsInBlock;t++){var o=e.substring(t*a.Constants.lineLength,(t+1)*a.Constants.lineLength);if(r=i.Keyword.isLastLine(o))break;n.push(i.KeywordsManager.parseKeyword(o))}return null})}).then(function(){return{header:n,bytesRead:s}})},e.readHduAsync=function(t,r){var n={header:null,data:null,bytesRead:0};return e.readHeaderAsync(t,r).then(function(a){var o=i.KeywordsManager.getValue(a.header,"NAXIS",0);return n.header=a.header,n.bytesRead+=a.bytesRead,0!==o?e.readDataAsync(t,r+a.bytesRead,a.header):null}).then(function(t){return n.data=t,n.bytesRead+=e.readDataSize(n.header),n})},e.readDataAsync=function(e,t,r){var n=s.RegisteredDataReaders.filter(function(e){return e.canReadData(r)});return 1===n.length?n[0].readDataAsync(e,t,r):void console.error("SlimFits was unable to read this file.")},e.readDataSize=function(e){var t=s.RegisteredDataReaders.filter(function(t){return t.canReadData(e)});return 1===t.length?t[0].readDataSize(e):void console.error("SlimFits was unable to read this file.")},e}();return e.FitsReader=u,r.define=n,t.exports}),System.register("sybilla/slimfits",["sybilla/FitsReader","sybilla/datasource/BlobFile","sybilla/datasource/MultipleRequestFile","sybilla/datasource/SingleRequestFile"],!0,function(require,e,t){var r=System.global,n=r.define;r.define=void 0;var a=require("sybilla/FitsReader");e.FitsReader=a.FitsReader;var i=require("sybilla/datasource/BlobFile");e.BlobFile=i.BlobFile;var o=require("sybilla/datasource/MultipleRequestFile");e.MultipleRequestFile=o.MultipleRequestFile;var s=require("sybilla/datasource/SingleRequestFile");return e.SingleRequestFile=s.SingleRequestFile,r.define=n,t.exports});
//# sourceMappingURL=slimfits.min.js.map
